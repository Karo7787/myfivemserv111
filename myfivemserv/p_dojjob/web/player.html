<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <title>Document</title>
</head>
<style>
    body {
        margin: 0; padding: 0;
        background-color: transparent;
    }

    .player {
        position: absolute;
        top: 0; left: 0; background-color: rgb(73, 73, 73);
        width: 100%; height: 100%;
        display: flex; align-items: center; justify-content: center;
        font-size: 2.5rem;
    }

    .player img {
        width: 100%; height: 100%; object-fit: contain;
    }
</style>
<body>
    <div class="player" id="player">
        <span>NO SIGNAL...</span>
    </div>
</body>
<script>
    var player;
    var playerUrl;

    const getUrlId = ((link) => {
        if (link == null) return;
        let url = link.toString();
        var regExp = /^.*(youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
        var match = url.match(regExp);
        if (match && match[2].length == 11) {
            return match[2];
        }
    })

    window.addEventListener('message', (event) => {
        const data = event.data;
        switch (data.action) {
            case 'playVideo':
                if (player) {
                    player.destroy();
                    player = null;
                }

                let url;
                if (data.data.url) {
                    url = getUrlId(data.data.url);
                    playerUrl = url;
                } else {
                    url = playerUrl;
                }
                
                if (!url) return;
                player = new YT.Player('player', {
                    height: '100%',
                    width: '100%',
                    videoId: url,
                    playerVars: {
                        autoplay: 1,
                        controls: 0,
                        showinfo: 0,
                        rel: 0,
                        modestbranding: 1,
                        playsinline: 1
                    },
                    events: {
                        onReady: (event) => {
                            event.target.playVideo();
                            event.target.seekTo(data.data.time);
                        },
                        onStateChange: (event) => {
                            if (event.data == YT.PlayerState.ENDED) {
                                player.destroy();
                                player = null;
                            }
                        }
                    }
                });
                break;
            case 'displayPhoto':
                $('.player').html(`<img src="${data.data}" alt="Image not found">`);
                break;
            case 'disableTV':
                if (player) {
                    player.destroy();
                    player = null;
                }
                $('.player').html('<span>NO SIGNAL...</span>');
                break;
        }
    })
</script>
</html>