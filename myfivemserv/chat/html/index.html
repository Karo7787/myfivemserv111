<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title></title>
  <link href="vendor/flexboxgrid.6.3.1.min.css" rel="stylesheet"></link>
  <link href="vendor/animate.3.5.2.min.css" rel="stylesheet"></link>
  <link href="index.css" rel="stylesheet"></link>
  <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v6.0.0-beta1/css/all.css">

  <script src="vendor/vue.2.3.3.min.js" type="text/javascript"></script>
  <script src="config.default.js" type="text/javascript"></script>
  <script src="config.js" type="text/javascript"></script>
</head>
<body>
  <div id="app"></div>

  <!-- App Template -->
  <script type="text/x-template" id="app_template">
    <div id="app">
      <div class="chat-window" :style="this.style" :class="{ 'fadeOutUp animated': !showWindow, 'fadeInDown animated': showWindow}">
        <div class="chat-messages" ref="messages">
          <message v-for="msg in messages"
                   :templates="templates"
                   :multiline="msg.multiline"
                   :args="msg.args"
                   :params="msg.params"
                   :color="msg.color"
                   :template="msg.template"
                   :template-id="msg.templateId"
                   :key="msg.id">
          </message>
        </div>
      </div>
      <div class="chat-input">
        <div v-show="showInput" class="input">
          <div class="chatinput-box" style="--color: rgba(255, 158, 48, 0.88)">
            <div class="message-icon">
                <i class="icon-svg fa-solid fa-keyboard"></i>
                <svg class="icon-hexagon" xmlns="http://www.w3.org/2000/svg" viewBox="45 45 930 930">
                    <path fill="#040e1b" stroke="rgba(255, 158, 48, 0.88)" stroke-width="24" d="M896 704C896 720.213333 887.04 734.293333 873.386667 741.546667L536.32 930.986667C529.493333 936.106667 520.96 938.666667 512 938.666667 503.04 938.666667 494.506667 936.106667 487.68 930.986667L150.613333 741.546667C136.96 734.293333 128 720.213333 128 704L128 320C128 303.786667 136.96 289.706667 150.613333 282.453333L487.68 93.013333C494.506667 87.893333 503.04 85.333333 512 85.333333 520.96 85.333333 529.493333 87.893333 536.32 93.013333L873.386667 282.453333C887.04 289.706667 896 303.786667 896 320L896 704Z"/>
                </svg>
                <div class="icon-background" style="--color: rgba(255, 158, 48, 0.88)"></div>
            </div>
            <textarea class="message-title" v-model="message"
                    ref="input"
                    type="text"
                    autofocus
                    spellcheck="false"
                    rows="1"
                    @keyup.esc="hideInput"
                    @keyup="keyUp"
                    @keydown="keyDown"
                    @keypress.enter.prevent="send">
            </textarea>
          </div>
        </div>
        <suggestions :message="message" :suggestions="suggestions">
        </suggestions>
      </div>
    </div>
  </script>

  <!-- Message Template -->
  <script type="text/x-template" id="message_template">
    <div class="msg" :class="{ multiline }">
      <span v-html="textEscaped"></span>
    </div>
  </script>

  <!-- Suggestions Template -->
  <script type="text/x-template" id="suggestions_template">
    <div class="suggestions-wrap" v-show="currentSuggestions.length > 0" style="--color: rgba(255, 158, 48, 0.88)">
      <div class="message-icon">
          <i class="icon-svg fa-solid fa-lightbulb"></i>
          <svg class="icon-hexagon" xmlns="http://www.w3.org/2000/svg" viewBox="45 45 930 930">
              <path fill="#040e1b" stroke="rgba(255, 158, 48, 0.88)" stroke-width="24" d="M896 704C896 720.213333 887.04 734.293333 873.386667 741.546667L536.32 930.986667C529.493333 936.106667 520.96 938.666667 512 938.666667 503.04 938.666667 494.506667 936.106667 487.68 930.986667L150.613333 741.546667C136.96 734.293333 128 720.213333 128 704L128 320C128 303.786667 136.96 289.706667 150.613333 282.453333L487.68 93.013333C494.506667 87.893333 503.04 85.333333 512 85.333333 520.96 85.333333 529.493333 87.893333 536.32 93.013333L873.386667 282.453333C887.04 289.706667 896 303.786667 896 320L896 704Z"/>
          </svg>
          <div class="icon-background" style="--color: rgba(255, 158, 48, 0.88)"></div>
      </div>
      <ul class="suggestions">
          <li class="suggestion" v-for="s in currentSuggestions" :key="s.name">
              <p>
              <span :class="{ 'disabled': s.disabled }">
                  {{s.name}}
              </span>
              <span class="param"
                      v-for="p in s.params"
                      :class="{ 'disabled': p.disabled }"
                      :key="p.name">
                  [{{p.name}}]
              </span>
              </p>
              <small class="help">
              <template v-if="!s.disabled">
                  {{s.help}}
              </template>
              <template v-for="p in s.params" v-if="!p.disabled">
                  {{p.help}}
              </template>
              </small>
          </li>
      </ul>
  </div>
  </script>

  <!-- Scripts -->
  <script type="text/javascript" src="./Suggestions.js"></script>
  <script type="text/javascript" src="./Message.js"></script>
  <script type="text/javascript" src="./App.js"></script>

  <!-- Main Entry -->
  <script type="text/javascript">
  window.post = (url, data) => {
    var request = new XMLHttpRequest();
    request.open('POST', url, true);
    request.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
    request.send(data);
  }

  const instance = new Vue({
    el: '#app',
    render: h => h(APP),
  });

  window.emulate = (type, detail = {}) => {
    detail.type = type;
    window.dispatchEvent(new CustomEvent('message', {
      detail,
    }));
  };
  </script>

</body>
</html>
